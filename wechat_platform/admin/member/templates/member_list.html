{% extends 'base/admin.html' %}
{% load staticfiles i18n %}

{% block content %}
    <div id="container"></div>

    <script type="text/template" id="app-breadcrumb-template">
        <h1>
            <span id="breadcrumb-title"><%= title %></span>
            <small id="breadcrumb-subtitle"><%= subtitle %></small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="{% url 'admin:dashboard:dashboard' %}"><i class="fa fa-dashboard"></i> 仪表盘</a></li>
            <% _.each(breadcrumbs, function(breadcrumb, index, list) { %>
            <%     if (index < _.size(list) - 1) { %>
                       <li><a href="<%= breadcrumb.url %>"><%= breadcrumb.title %></a></li>
            <%     } else { %>
                       <li class="active"><%= breadcrumb.title %></li>
            <%     } %>
            <% }); %>
        </ol>
    </script>

    <script type="text/template" id="app-template">
        <aside class="right-side">
            <section class="content">
                <div class="row">
                    <div class="col-xs-12">
                        <div id="header"></div>
                        <div id="content"></div>
                    </div>
                </div>
            </section>
        </aside>
    </script>

    <script type="text/template" id="app-header-list-template">
        <div class="content-header">
            <div class="list-operation">
                <div class="pull-right">
                    <a href="#/add_user" class="btn btn-primary"><i class="fa fa-fw fa-plus-circle"></i> <strong>添加用户</strong></a>
                </div>
            </div>
        </div>
    </script>

    <script type="text/template" id="app-header-add-user-template">
        <div class="content-header">
            <div class="list-operation">
                <div>
                    <a href="#" class="btn btn-default"><i class="fa fa-fw fa-arrow-circle-o-left"></i> <strong>返回用户列表</strong></a>
                </div>
            </div>
        </div>
    </script>

    <script type="text/template" id="member-list-template">
        <div class="box">
            <div class="box-body table-responsive no-padding">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th style="min-width: 150px">用户名</th>
                            <th style="min-width: 150px">昵称</th>
                            <th style="min-width: 250px">电子邮件地址</th>
                            <th style="min-width: 150px">所属用户组</th>
                            <th style="min-width: 150px">注册时间</th>
                            <th style="min-width: 120px">操作</th>
                        </tr>
                    </thead>
                    <tbody class="list"></tbody>
                </table>
            </div>
            <!-- /.box-body -->
        </div>
    </script>

    <script type="text/template" id="member-item-template">
        <td><%= username %></td>
        <td><%= nickname %></td>
        <td><%= email %></td>
        <% if (groups.length > 0) { %>
        <td>
        <%     _.each(groups, function(group) { %>
        <%         if (group['name'] == '超级管理员') { %>
                       <small class="badge bg-red"><%= group['name'] %></small>
        <%         } else if (group['name'] == '管理员') { %>
                       <small class="badge bg-light-blue"><%= group['name'] %></small>
        <%         } else { %>
                       <small class="badge"><%= group['name'] %></small>
        <%         } %>
        <%     }); %>
        </td>
        <% } else { %>
        <td>无用户组</td>
        <% } %>
        <td><%= date_joined %></td>
        <td>
            <button type="button" class="btn btn-xs btn-default edit">编辑</button>
            <button type="button" class="btn btn-xs btn-danger delete">删除</button>
        </td>
    </script>

    <script type="text/template" id="member-add-user-template">
        <hr>
        <form class="form-horizontal" role="form" id="add-user-form">
            <div class="form-group">
                <label for="inputEmail3" class="col-sm-2 control-label">用户名 <span class="text-red">*</span></label>
                <div class="col-sm-9">
                    <input type="text" class="form-control" name="username" id="username">
                    <!--<label class="control-label text-red">用户名不能为空</label>-->
                </div>
            </div>
            <div class="form-group">
                <label for="inputPassword3" class="col-sm-2 control-label">电子邮件 <span class="text-red">*</span></label>
                <div class="col-sm-9">
                    <input type="text" class="form-control" name="email" id="email">
                </div>
            </div>
            <div class="form-group">
                <label for="inputPassword3" class="col-sm-2 control-label">昵称 <span class="text-red">*</span></label>
                <div class="col-sm-9">
                    <input type="text" class="form-control" name="nickname" id="nickname">
                </div>
            </div>
            <div class="form-group">
                <label for="inputPassword3" class="col-sm-2 control-label">密码 <span class="text-red">*</span></label>
                <div class="col-sm-9">
                    <input type="password" class="form-control" name="password" id="password">
                </div>
            </div>
            <div class="form-group">
                <label for="inputPassword3" class="col-sm-2 control-label">确认密码 <span class="text-red">*</span></label>
                <div class="col-sm-9">
                    <input type="password" class="form-control" name="password_confirm" id="password_confirm">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 control-label">所属用户组 <span class="text-red">*</span></label>
                <div class="col-sm-9">
                    <label class="checkbox-inline">
                        <input type="checkbox" class="groups" name="groups" value="1"> 超级管理员
                    </label>
                    <label class="checkbox-inline">
                        <input type="checkbox" class="groups" name="groups" value="2"> 管理员
                    </label>
                    <label class="checkbox-inline">
                        <input type="checkbox" class="groups" name="groups" value="3"> 用户
                    </label>
                    <span class="help-block">提示：用户组可多选，每次权限检查将取所选所有用户组中的最大值</span>
                </div>
            </div>
            <hr>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-2">
                    <button type="submit" class="btn btn-primary btn-block">添加用户</button>
                </div>
            </div>
        </form>
    </script>

    <div class="modal fade" id="confirm-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">关闭</span></button>
                    <h4 class="modal-title" id="myModalLabel"></h4>
                </div>
                <div class="modal-body"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-danger btn-ok">确认</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    {{ block.super }}
    <script src="{% static 'js/jquery.validate.min.js' %}"></script>
    <script src="{% static 'js/admin/member.js' %}"></script>
{% endblock %}